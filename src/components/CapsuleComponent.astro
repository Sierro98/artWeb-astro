---
import { Image } from "astro:assets";
import { getXataClient } from "../xata";

const xata = getXataClient();

const data = await xata.db.capsules.getPaginated({ pagination: { size: 20 } });

//TODO: Finish creating this component
---

<div
  class="px-5 pb-7 md:px-10 md:pb-14 col-auto flex flex-wrap justify-center gap-20 sm:col-1 items-center"
>
  {
    data.records.map((record) => {
      return (
        <a
          href={`/capsules/${record.name}`}
          class="flex flex-col items-center w-fit md:w-3/6 lg:w-1/4 h-auto rounded-lg shadow-2xl p-6 bg-gray-300 md:hover:scale-110 transition duration-300 ease-out backdrop-filter backdrop-blur-lg"
        >
          <div
            class="absolute -z-10 -inset-1 bg-cover bg-center blur filter group-hover:scale-110 transition duration-300 ease-out"
            style={{ backgroundImage: `url(${record.head_image?.url || ""})` }}
          />

          <Image
            class="object-cover rounded-lg relative z-10"
            densities={[0.1]}
            src={record.head_image?.url || ""}
            inferSize
            alt={record.name || ""}
          />
          <h2 class="py-4 azeret-bold text-3xl relative z-10 text-gray-100">{record.name}</h2>
        </a>
      );
    })
  }
</div>
