---
import { Image } from "astro:assets";
import { localizePath } from "../../node_modules/astro-i18next";
import { getXataClient } from "../xata";

const xata = getXataClient();

const capsule2show = await xata.db.home_show
  .select(["id", "capsule.name"])
  .filter("Carousel", "Product")
  .getFirst();
const capsuleImg = await xata.db.works
  .filter("collection.name", capsule2show?.capsule?.name)
  .sort("name", "asc")
  .getPaginated({ pagination: { size: 4 } });

type Props = {
  destination: string;
};

const { destination } = Astro.props;
const imgDescription: string = "Products to buy";
const imgWidth = 500;
const imgHeight = 450;
---

<div class="pb-12">
  <a href={localizePath(destination)} class="scroll-order">
    <div class="scroll-order-slide">
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(0)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(1)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
      <div class="align-middle">
        <h1 class="sm:text-9xl text-8xl font-bold text-black azeret-bold">ORDER NOW!</h1>
        <h1 class="sm:text-9xl text-8xl font-bold text-black azeret-bold">ORDER NOW!</h1>
        <h1 class="sm:text-9xl text-8xl font-bold text-black azeret-bold">ORDER NOW!</h1>
      </div>
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(2)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(3)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
    </div>
    <div class="scroll-order-slide">
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(0)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(1)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
      <div class="align-middle">
        <h1 class="sm:text-9xl text-8xl font-bold text-black azeret-bold">ORDER NOW!</h1>
        <h1 class="sm:text-9xl text-8xl font-bold text-black azeret-bold">ORDER NOW!</h1>
        <h1 class="sm:text-9xl text-8xl font-bold text-black azeret-bold">ORDER NOW!</h1>
      </div>
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(2)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
      <Image
        format="avif"
        quality={"max"}
        src={capsuleImg.records.at(3)?.images?.url || ""}
        alt={imgDescription}
        height={imgHeight}
        width={imgWidth}
      />
    </div>
  </a>
</div>

<style>
  .scroll-order {
    display: block;
    position: relative;
    width: 100%;
    height: 450px;
    background-color: transparent;
    overflow: hidden !important;
    white-space: nowrap;
    z-index: 1;
  }
  .scroll-order-slide {
    animation: scrollText 65s infinite linear;
    display: inline-block;
    justify-content: space-between;
    align-items: center;
    position: relative;
    white-space: nowrap;
  }
  .scroll-order img {
    height: 450px;
    min-width: 500px;
    object-fit: cover;
    display: inline-block;
    margin: 0 20px;
    color: white;
  }
  .scroll-order div {
    display: inline-block;
    margin: 0 20px;
  }
  @keyframes scrollText {
    from {
      transform: translateX(0%);
    }
    to {
      transform: translateX(-100%);
    }
  }
</style>
